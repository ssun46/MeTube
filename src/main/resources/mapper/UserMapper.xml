<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dev.metube.mapper.UserMapper">
	<resultMap id="UserResultMap" type="com.dev.metube.model.User">
		<result column="sex" jdbcType="SMALLINT" property="sex" typeHandler="org.apache.ibatis.type.EnumOrdinalTypeHandler"/>
		<result column="type" jdbcType="SMALLINT" property="type" typeHandler="org.apache.ibatis.type.EnumOrdinalTypeHandler"/>
		<result column="status" jdbcType="SMALLINT" property="status" typeHandler="org.apache.ibatis.type.EnumOrdinalTypeHandler"/>
	</resultMap>
	
	<insert id="insert" parameterType="com.dev.metube.model.User">
		INSERT INTO tb_user (
			username,
			password,
			display_name,
			sex,
			phone,
			address,
			register_date
		)
		VALUES (
			#{username},
			#{password},
			#{display_name},
			#{sex},
			#{phone},
			#{address},
			now()
		)
	</insert>
	
	<select id="selectByUsername" parameterType="string" resultMap="UserResultMap">
		SELECT
			id, username, password, display_name, sex, phone, address, register_date, type, status
		FROM
			tb_user
		WHERE
			username LIKE #{username}
	</select>
	
	<select id="selectUserExist" parameterType="string" resultType="boolean">
		SELECT EXISTS (
			SELECT
				id
			FROM
				tb_user
			WHERE
				username LIKE #{username}
		)
	</select>
</mapper>